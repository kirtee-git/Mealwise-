<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MealWise ‚Äì Mess Poll</title>
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    .poll-page { padding: 50px 60px; }

    /* ===== MAIN LAYOUT ===== */
    .poll-layout {
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      gap: 40px;
      align-items: start;
    }

    /* ===== STAT CARDS ===== */
    .poll-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 28px;
    }

    .poll-stat-card {
      background: white;
      border-radius: 14px;
      padding: 20px;
      border: 1.5px solid var(--border);
      box-shadow: var(--shadow);
      text-align: center;
    }

    .poll-stat-card .num {
      font-family: 'Nunito', sans-serif;
      font-size: 30px;
      font-weight: 900;
      color: var(--navy);
    }

    .poll-stat-card .lbl {
      font-size: 11px;
      color: var(--muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* ===== POLL CARD ===== */
    .poll-card {
      background: white;
      border-radius: 20px;
      padding: 28px;
      border: 1.5px solid var(--border);
      box-shadow: var(--shadow);
      margin-bottom: 20px;
    }

    .poll-question {
      font-size: 16px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 18px;
    }

    .poll-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1.5px solid var(--border);
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
      font-weight: 500;
    }

    .poll-option:hover { border-color: var(--accent); background: var(--light-blue); }
    .poll-option.chosen { border-color: var(--accent); background: var(--light-blue); }

    .poll-option input[type="radio"] {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }

    .poll-option-bar { flex: 1; }

    .poll-option-label {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      margin-bottom: 5px;
      font-weight: 600;
      color: var(--navy);
    }

    .poll-fill-bg {
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      overflow: hidden;
    }

    .poll-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    .poll-meta {
      font-size: 11px;
      color: var(--muted);
      margin-top: 12px;
    }

    /* ===== RIGHT COLUMN ===== */
    .attendance-chart {
      background: white;
      border-radius: 16px;
      padding: 28px;
      border: 1.5px solid var(--border);
      box-shadow: var(--shadow);
      margin-bottom: 24px;
    }

    .attendance-chart h4 {
      font-size: 15px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 24px;
    }

    .week-bars {
      display: flex;
      align-items: flex-end;
      gap: 12px;
      height: 140px;
    }

    .week-bar-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .week-bar {
      width: 100%;
      border-radius: 6px 6px 0 0;
      background: linear-gradient(180deg, var(--accent) 0%, var(--navy) 100%);
      transition: height 0.6s ease;
    }

    .week-bar.low {
      background: linear-gradient(180deg, var(--orange) 0%, #d97706 100%);
    }

    .week-label {
      font-size: 10px;
      color: var(--muted);
      margin-top: 6px;
    }

    .week-count {
      font-size: 10px;
      font-weight: 700;
      color: var(--navy);
      margin-top: 2px;
    }

    .card-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .live-dot {
      width: 8px; height: 8px;
      background: var(--green);
      border-radius: 50%;
      display: inline-block;
      margin-right: 4px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50%       { opacity: 0.4; }
    }

    @media (max-width: 900px) {
      .poll-page   { padding: 24px; }
      .poll-layout { grid-template-columns: 1fr; }
      .poll-stats  { grid-template-columns: repeat(4, 1fr); }
    }
  </style>
</head>
<body>

  <script src="../js/main.js"></script>
  <script>renderNavbar(); renderToast();</script>

  <div class="poll-page">

    <div class="section-header">
      <h2>üìä Mess Attendance Poll</h2>
      <p>
        Help us plan better! Vote on your meal preferences and see how many
        students are coming for each meal session today.
      </p>
    </div>

    <div class="poll-layout">

      <!-- LEFT: POLLS -->
      <div>
        <!-- STATS -->
        <div class="poll-stats">
          <div class="poll-stat-card">
            <div class="num">342</div>
            <div class="lbl">Total Students</div>
          </div>
          <div class="poll-stat-card">
            <div class="num" id="voted-count">287</div>
            <div class="lbl">Voted Today</div>
          </div>
          <div class="poll-stat-card">
            <div class="num">84%</div>
            <div class="lbl">Participation</div>
          </div>
          <div class="poll-stat-card">
            <div class="num">3</div>
            <div class="lbl">Active Polls</div>
          </div>
        </div>

        <!-- POLL 1: LUNCH -->
        <div class="poll-card">
          <div class="poll-question">üçΩÔ∏è Will you come for lunch today?</div>

          <label class="poll-option" id="opt-p1-yes" onclick="votePoll('p1','yes')">
            <input type="radio" name="poll1" value="yes" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>Yes, definitely</span>
                <span id="p1-yes-pct">65%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p1-yes-fill" style="width:65%;background:var(--accent)"></div>
              </div>
            </div>
          </label>

          <label class="poll-option" id="opt-p1-no" onclick="votePoll('p1','no')">
            <input type="radio" name="poll1" value="no" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>No, skipping</span>
                <span id="p1-no-pct">20%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p1-no-fill" style="width:20%;background:var(--red)"></div>
              </div>
            </div>
          </label>

          <label class="poll-option" id="opt-p1-maybe" onclick="votePoll('p1','maybe')">
            <input type="radio" name="poll1" value="maybe" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>Maybe</span>
                <span id="p1-maybe-pct">15%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p1-maybe-fill" style="width:15%;background:var(--orange)"></div>
              </div>
            </div>
          </label>

          <div class="poll-meta">187 votes ‚Ä¢ Closes at 11:00 AM</div>
        </div>

        <!-- POLL 2: DINNER -->
        <div class="poll-card">
          <div class="poll-question">üåô Will you come for dinner tonight?</div>

          <label class="poll-option" id="opt-p2-yes" onclick="votePoll('p2','yes')">
            <input type="radio" name="poll2" value="yes" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>Yes</span>
                <span id="p2-yes-pct">72%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p2-yes-fill" style="width:72%;background:var(--accent)"></div>
              </div>
            </div>
          </label>

          <label class="poll-option" id="opt-p2-no" onclick="votePoll('p2','no')">
            <input type="radio" name="poll2" value="no" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>No</span>
                <span id="p2-no-pct">28%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p2-no-fill" style="width:28%;background:var(--red)"></div>
              </div>
            </div>
          </label>

          <div class="poll-meta">100 votes ‚Ä¢ Closes at 5:00 PM</div>
        </div>

        <!-- POLL 3: FOOD QUALITY -->
        <div class="poll-card">
          <div class="poll-question">‚≠ê How was today's breakfast quality?</div>

          <label class="poll-option" id="opt-p3-great" onclick="votePoll('p3','great')">
            <input type="radio" name="poll3" value="great" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>Excellent üòç</span>
                <span id="p3-great-pct">50%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p3-great-fill" style="width:50%;background:var(--green)"></div>
              </div>
            </div>
          </label>

          <label class="poll-option" id="opt-p3-ok" onclick="votePoll('p3','ok')">
            <input type="radio" name="poll3" value="ok" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>It was okay üôÇ</span>
                <span id="p3-ok-pct">35%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p3-ok-fill" style="width:35%;background:var(--orange)"></div>
              </div>
            </div>
          </label>

          <label class="poll-option" id="opt-p3-bad" onclick="votePoll('p3','bad')">
            <input type="radio" name="poll3" value="bad" />
            <div class="poll-option-bar">
              <div class="poll-option-label">
                <span>Needs improvement üòï</span>
                <span id="p3-bad-pct">15%</span>
              </div>
              <div class="poll-fill-bg">
                <div class="poll-fill" id="p3-bad-fill" style="width:15%;background:var(--red)"></div>
              </div>
            </div>
          </label>

          <div class="poll-meta">74 votes ‚Ä¢ Open now</div>
        </div>
      </div>

      <!-- RIGHT: CHARTS -->
      <div>
        <!-- WEEKLY BAR CHART -->
        <div class="attendance-chart">
          <h4>üìà Weekly Attendance ‚Äî Students Coming to Mess</h4>
          <div class="week-bars">
            <div class="week-bar-group">
              <div class="week-bar" style="height:110px;"></div>
              <div class="week-label">Mon</div>
              <div class="week-count">298</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar" style="height:95px;"></div>
              <div class="week-label">Tue</div>
              <div class="week-count">258</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar" style="height:120px;"></div>
              <div class="week-label">Wed</div>
              <div class="week-count">325</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar low" style="height:70px;"></div>
              <div class="week-label">Thu</div>
              <div class="week-count">190</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar" style="height:130px;"></div>
              <div class="week-label">Fri</div>
              <div class="week-count">342</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar low" style="height:50px;"></div>
              <div class="week-label">Sat</div>
              <div class="week-count">136</div>
            </div>
            <div class="week-bar-group">
              <div class="week-bar low" style="height:35px;"></div>
              <div class="week-label">Sun</div>
              <div class="week-count">95</div>
            </div>
          </div>
        </div>

        <!-- TODAY MEAL-WISE -->
        <div class="card">
          <div class="card-title">
            üïê Today's Meal-wise Count
            <span><span class="live-dot"></span>Live</span>
          </div>
          <div>
            <div class="as-row">
              <div class="as-meal">‚òÄÔ∏è Breakfast</div>
              <div class="as-bar-container">
                <div class="as-bar"><div class="as-fill" style="width:88%;"></div></div>
              </div>
              <div class="as-count">301</div>
            </div>
            <div class="as-row">
              <div class="as-meal">üå§Ô∏è Lunch</div>
              <div class="as-bar-container">
                <div class="as-bar"><div class="as-fill" style="width:65%;"></div></div>
              </div>
              <div class="as-count">222</div>
            </div>
            <div class="as-row">
              <div class="as-meal">üçµ Snacks</div>
              <div class="as-bar-container">
                <div class="as-bar"><div class="as-fill" style="width:45%;"></div></div>
              </div>
              <div class="as-count">154</div>
            </div>
            <div class="as-row">
              <div class="as-meal">üåô Dinner</div>
              <div class="as-bar-container">
                <div class="as-bar"><div class="as-fill" style="width:72%;"></div></div>
              </div>
              <div class="as-count">246</div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    const votes = {};

    function votePoll(poll, choice) {
      // Clear previous selection highlight for this poll
      document.querySelectorAll(`[id^="opt-${poll}-"]`).forEach(el => el.classList.remove('chosen'));
      document.getElementById(`opt-${poll}-${choice}`).classList.add('chosen');
      votes[poll] = choice;
      showToast('Your vote has been recorded! üìä');
    }
  </script>

</body>
</html>
